from numpy import array


def cigre_b4_dc():
    """
    Power flow data for the DC part of the CIGRE B4 hybrid test network.
    Test network data is adopted from the official CIGRE report titled
    "The CIGRE B4 DC Grid Test System".
    """
    # Initialize a dictionary to store the DC network data
    pdc = dict.fromkeys(['version', 'baseMVAac', 'baseMVAdc', 'pol', 'busdc', 'convdc', 'convdcdc', 'branchdc'])

    # Define the PyACDC case format version
    pdc['version'] = '1'

    # Define the base MVA for the AC and the DC system
    pdc['baseMVAac'] = 100.0
    pdc['baseMVAdc'] = 100.0

    # Define the DC grid topology (1 for monopolar DC grid and 2 for symmetrically-grounded monopolar and bipolar DC grid)
    pdc['pol'] = 2.0

    # DC bus data
    # busdc_i   busac_i grid    Pdc Vdc basekVdc    Vdcmax  Vdcmin  Cdc
    pdc['busdc'] = array([
        [11, 11, 1, 0, 1, 200, 1.1, 0.9, 0],
        [12, 31, 1, 0, 1, 200, 1.1, 0.9, 0],
        [21, 22, 2, 0, 1, 200, 1.1, 0.9, 0],
        [22, 23, 2, 0, 0.99, 200, 1.1, 0.9, 0],
        [23, 0, 2, 0, 1, 200, 1.1, 0.9, 0],
        [24, 61, 2, 0, 1, 200, 1.1, 0.9, 0],
        [25, 51, 2, 0, 1, 200, 1.1, 0.9, 0],
        [31, 11, 3, 0, 1.01, 400, 1.1, 0.9, 0],
        [32, 32, 3, 0, 1, 400, 1.1, 0.9, 0],
        [33, 41, 3, 0, 1, 400, 1.1, 0.9, 0],
        [34, 0, 3, 0, 1, 400, 1.1, 0.9, 0],
        [35, 0, 3, 0, 1, 400, 1.1, 0.9, 0],
        [36, 21, 3, 0, 1, 400, 1.1, 0.9, 0],
        [37, 0, 3, 0, 1, 400, 1.1, 0.9, 0],
        [38, 22, 3, 0, 1, 400, 1.1, 0.9, 0]
    ])

    # AC/DC converter data
    # busdc_i   type_dc type_ac P_g Q_g Vtar    rtf xtf bf  rc  xc  basekVac    Vmax   Vmin   Imax    status  LossA   LossB   LossCrec    LossCinv
    pdc['convdc'] = array([
        [11, 2, 1, 0, 0, 1, 0, 0, 0, 0, 0, 380, 1.1, 0.9, 8, 1, 0, 0, 14.44, 14.44],
        [12, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 145, 1.1, 0.9, 8, 1, 0, 0, 2.1025, 2.1025],
        [21, 2, 1, 0, 0, 1, 0, 0, 0, 0, 0, 380, 1.1, 0.9, 8, 1, 0, 0, 14.44, 14.44],
        [22, 1, 2, 800, 0, 1, 0, 0, 0, 0, 0, 380, 1.1, 0.9, 12, 1, 0, 0, 14.42806612, 14.42806612],
        [24, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 145, 1.1, 0.9, 8, 1, 0, 0, 2.1025, 2.1025],
        [25, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 145, 1.1, 0.9, 2, 1, 0, 0, 2.1025, 2.1025],
        [31, 2, 2, 0, 0, 1, 0, 0, 0, 0, 0, 380, 1.1, 0.9, 24, 1, 0, 0, 28.85613223, 28.85613223],
        [36, 1, 2, 1500, 0, 1, 0, 0, 0, 0, 0, 380, 1.1, 0.9, 24, 1, 0, 0, 28.85613223, 28.85613223],
        [38, 1, 2, 1700, 0, 1, 0, 0, 0, 0, 0, 380, 1.1, 0.9, 24, 1, 0, 0, 28.85613223, 28.85613223],
        [32, 1, 2, -600, 0, 1, 0, 0, 0, 0, 0, 145, 1.1, 0.9, 8, 1, 0, 0, 4.205, 4.205],
        [32, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 145, 1.1, 0.9, 16, 1, 0, 0, 4.205, 4.205],
    ])

    # DC/DC converter data
    # cbusdc    mbusdc  d_ratio r_dcdc  g_dcdc  ratedc_dcdc l_dcdc  c_dcdc  status_dcdc
    # pdc['convdcdc'] = array(
    #     [
    #         [36, 35, 0.99595, 0.012, 0.00025, 20, 0, 0, 1],
    #         [25, 34, 0.50280, 0.012, 0.00025, 10, 0, 0, 1]
    #     ]
    # )

    # DC branch data
    # fbusdc    tbusdc  r   l   c   rateA   rateB   rateC   status
    pdc["branchdc"] = array([
        [11, 12, 0.00475, 0.331595105, 5.287928755, 392.4, 392.4, 392.4, 1],
        [21, 22, 0.00475, 0.331595105, 5.287928755, 392.4, 392.4, 392.4, 1],
        [22, 23, 0.003325, 0.06497599, 0.174672552, 600, 600, 600, 1],
        [23, 24, 0.002375, 0.165797552, 2.643964377, 392.4, 392.4, 392.4, 1],
        [24, 25, 0.00475, 0.331595105, 5.287928755, 392.4, 392.4, 392.4, 1],
        [31, 32, 0.0011875, 0.082938046, 19.16120191, 906, 906, 906, 1],
        [31, 36, 0.00285, 0.073481852, 2.473061737, 1400, 1400, 1400, 1],
        [31, 36, 0.00285, 0.073481852, 2.473061737, 1400, 1400, 1400, 1],
        [31, 37, 0.0035625, 0.091852315, 3.091327171, 1400, 1400, 1400, 1],
        [32, 33, 0.00178125, 0.124407069, 28.74180287, 906, 906, 906, 1],
        [33, 34, 0.0011875, 0.082938046, 19.16120191, 906, 906, 906, 1],
        [34, 35, 0.0011875, 0.082938046, 19.16120191, 906, 906, 906, 1],
        [36, 37, 0.001425, 0.036740926, 1.236530868, 1400, 1400, 1400, 1],
        [37, 38, 0.0021375, 0.055111389, 1.854796303, 1400, 1400, 1400, 1],
        [37, 38, 0.0021375, 0.055111389, 1.854796303, 1400, 1400, 1400, 1],
    ])

    return pdc